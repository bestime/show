
var testArr = [{"goods_id":"392624","goods_name":"甜玉米香肠","price":"1.50","curr_num":29,"letter":"TYMXC","type":"0","pic":"\/res\/img\/14\/14117\/goods\/2019-01-10\/5c36d83e0427d219116523.jpg","sort":"10"},{"goods_id":"273538","goods_name":"劲仔小鱼","price":"1.00","curr_num":7,"letter":"JZXY","type":"0","pic":"\/res\/img\/11\/11686\/attachment\/2018-10-16\/1b71c9bbd77597199c0c04fd2100ab88.jpg","sort":"10"},{"goods_id":"142720","goods_name":"王中王火腿肠","price":"1.00","curr_num":51,"letter":"WZWHTC","type":"0","pic":"\/res\/img\/Upload\/goods\/20170702\/7c301b5f410da69e3d20b83e320df77a.jpg","sort":"10"},{"goods_id":"142704","goods_name":"香辣鸭脖","price":"1.50","curr_num":0,"letter":"XLYB","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2018-12-15\/5c151fd6e52ee170810192.jpg","sort":"10"},{"goods_id":"366142","goods_name":"薯洋洋山药薄片90克","price":"6.00","curr_num":0,"letter":"SYYSYBP90K","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-02-24\/5c726903e9fc5172899644.jpg","sort":"11"},{"goods_id":"273567","goods_name":"丽芝士威化饼干","price":"3.00","curr_num":30,"letter":"LZSWHBG","type":"0","pic":"\/res\/img\/Upload\/goods\/20170525\/240_240_5926aedda9300.jpg","sort":"11"},{"goods_id":"142715","goods_name":"口水娃兰花豆","price":"4.00","curr_num":20,"letter":"KSWLHD","type":"0","pic":"\/res\/img\/12\/12176\/attachment\/2018-11-14\/de20a32f00a28b1fd94436c3fab2bf16.jpg","sort":"11"},{"goods_id":"142714","goods_name":"太平苏打饼干","price":"4.00","curr_num":1,"letter":"TPSDBG","type":"0","pic":"\/res\/img\/12\/12622\/attachment\/2018-11-23\/4a598f782e6893461ab9433d67edfb62.jpg","sort":"11"},{"goods_id":"142713","goods_name":"卫龙面筋","price":"3.00","curr_num":9,"letter":"WLMJ","type":"0","pic":"\/res\/img\/12\/12511\/attachment\/2018-11-20\/e34b7193c463ba16b2df51150c7ed8ec.jpg","sort":"11"},{"goods_id":"142706","goods_name":"金厨娘多味凤爪","price":"2.00","curr_num":120,"letter":"JCNDWFZ","type":"0","pic":"\/res\/img\/17\/17695\/attachment\/2019-02-07\/f387ea05a6e93dd9e628aeaf0995e72e.jpg","sort":"11"},{"goods_id":"366132","goods_name":"洞庭刁子鱼","price":"5.00","curr_num":16,"letter":"DTDZY","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-02-24\/5c72678698986415912146.jpg","sort":"12"},{"goods_id":"366131","goods_name":"洞庭腊鱼","price":"5.00","curr_num":2,"letter":"DTLY","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-02-24\/5c7267407da7d933621526.jpg","sort":"12"},{"goods_id":"347315","goods_name":"吴婷麻辣干子","price":"4.00","curr_num":9,"letter":"WTMLGZ","type":"0","pic":"\/res\/img\/Upload\/goods\/20170624\/240_240_594def1353848.jpg","sort":"12"},{"goods_id":"412095","goods_name":"波力海苔（小包）","price":"4.00","curr_num":10,"letter":"BLHTXB","type":"0","pic":"\/res\/img\/12\/12684\/attachment\/2018-11-26\/74f8deaa30315bd34868aecb1846eee0.jpg","sort":"13"},{"goods_id":"347314","goods_name":"恒康瓜子核桃味","price":"5.00","curr_num":7,"letter":"HKGZHTW","type":"0","pic":"\/res\/img\/Upload\/goods\/20180608\/5b1a57eeb3eb7.png","sort":"13"},{"goods_id":"142711","goods_name":"香翠緣咸干花生","price":"4.00","curr_num":20,"letter":"XCYXGHS","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2018-12-15\/5c15231ea5c75861650461.jpg","sort":"13"},{"goods_id":"366154","goods_name":"汤达人酸辣豚骨面","price":"6.00","curr_num":20,"letter":"TDRSLDGM","type":"0","pic":"\/res\/img\/fileupload\/supermarket\/2997aabad7518300420ee0463c0f0879.jpg","sort":"14"},{"goods_id":"297974","goods_name":"康师傅海鲜桶面","price":"5.00","curr_num":0,"letter":"KSFHXTM","type":"0","pic":"\/res\/img\/16\/16878\/attachment\/2019-01-16\/e7fbeb6c728590b48eb046c4b4248393.jpg","sort":"14"},{"goods_id":"211705","goods_name":"统一酸菜牛肉方便面","price":"5.00","curr_num":0,"letter":"TYSCNRFBM","type":"0","pic":"\/res\/img\/1\/1018\/attachment\/2018-05-25\/4d1456fc1e1ebffcdd7fa8ed7970b34a.jpg","sort":"14"},{"goods_id":"142717","goods_name":"康师傅香辣牛肉面","price":"5.00","curr_num":14,"letter":"KSFXLNRM","type":"0","pic":"\/res\/img\/fileupload\/supermarket\/83759fe41cc90c1d077983c0588ef416.jpg","sort":"14"},{"goods_id":"142716","goods_name":"康师傅红烧牛肉桶面","price":"5.00","curr_num":9,"letter":"KSFHSNRTM","type":"0","pic":"\/res\/img\/Upload\/goods\/20170328\/240_240_58da745ac9bc0.jpg","sort":"14"},{"goods_id":"393324","goods_name":"雄究究槟榔10元","price":"10.00","curr_num":9,"letter":"XJJBL10Y","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-03-06\/5c7f7043054bd434102645.jpg","sort":"15"},{"goods_id":"393205","goods_name":"雄究究槟榔15元","price":"15.00","curr_num":5,"letter":"XJJBL15Y","type":"0","pic":"\/res\/img\/15\/15088\/goods\/2019-01-05\/5c2f98fcb9fff278799496.jpg","sort":"15"},{"goods_id":"328692","goods_name":"张三疯槟榔15元","price":"15.00","curr_num":0,"letter":"ZSFBL15Y","type":"0","pic":"\/res\/img\/fileupload\/supermarket\/74639e33c7e1d80889d9064f71b424ed.jpg","sort":"15"},{"goods_id":"263036","goods_name":"15叼嘴巴槟榔","price":"15.00","curr_num":0,"letter":"15DZBBL","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-01-09\/5c35569e24365058084225.jpg","sort":"15"},{"goods_id":"174424","goods_name":"10元张三疯槟榔","price":"10.00","curr_num":0,"letter":"10YZSFBL","type":"0","pic":"\/res\/img\/12\/12447\/attachment\/2018-11-18\/1f7f7cba22319d2a573cffad94740f32.jpg","sort":"15"},{"goods_id":"153354","goods_name":"口味王15元槟榔","price":"15.00","curr_num":43,"letter":"KWW15YBL","type":"0","pic":"\/res\/img\/Upload\/goods\/20170524\/240_240_592513cd3b399.jpg","sort":"15"},{"goods_id":"142719","goods_name":"10元叼嘴巴","price":"10.00","curr_num":0,"letter":"10YDZB","type":"0","pic":"\/res\/img\/12\/12058\/attachment\/2018-11-08\/afb8793e1e82ebf97c59c7de4cdb4d7a.jpg","sort":"15"},{"goods_id":"273569","goods_name":"老李五香爪","price":"5.00","curr_num":0,"letter":"LLWXZ","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-01-11\/5c38681d7fa44158343708.jpg","sort":"20"},{"goods_id":"273568","goods_name":"意东糯米锅巴","price":"5.00","curr_num":0,"letter":"YDNMGB","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-01-11\/5c3867d80e670819652008.jpg","sort":"20"},{"goods_id":"173157","goods_name":"面包","price":"4.00","curr_num":0,"letter":"MB","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2018-12-22\/5c1dce7642cc0545964258.jpg","sort":"20"},{"goods_id":"142730","goods_name":"长白甘泉","price":"3.00","curr_num":9,"letter":"CBGQ","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2018-12-16\/5c15329bcf261425757606.jpg","sort":"30"},{"goods_id":"120886","goods_name":"统一阿萨姆奶茶","price":"5.00","curr_num":4,"letter":"TYASMNC","type":"0","pic":"\/res\/img\/12\/12338\/attachment\/2018-11-15\/fd585bcb7b200adb83b85aa2a5ca9a22.jpg","sort":"31"},{"goods_id":"120697","goods_name":"脉动青柠味饮料","price":"5.00","curr_num":14,"letter":"MDQNWYL","type":"0","pic":"\/res\/img\/Upload\/goods\/20170408\/normal_120603005_0.jpg","sort":"32"},{"goods_id":"120690","goods_name":"红牛","price":"6.00","curr_num":28,"letter":"HN","type":"0","pic":"\/res\/img\/0\/0\/attachment\/2018-07-12\/3c14528eaa07629d127c8db699a5ec58.jpg","sort":"33"},{"goods_id":"120885","goods_name":"乐虎瓶装","price":"6.00","curr_num":23,"letter":"LHPZ","type":"0","pic":"\/res\/img\/11\/11707\/attachment\/2018-10-19\/dd5a72846ed6a99c06087ea89297744a.jpg","sort":"34"},{"goods_id":"392966","goods_name":"名仁柠檬苏打水","price":"3.00","curr_num":21,"letter":"MRNMSDS","type":"0","pic":"\/res\/img\/17\/17637\/goods\/2019-02-05\/5c590c2e87cc7312931072.jpg","sort":"35"},{"goods_id":"392965","goods_name":"名仁苏打水","price":"3.00","curr_num":10,"letter":"MRSDS","type":"0","pic":"\/res\/img\/Upload\/goods\/20170401\/171446_1465315446.jpg","sort":"35"},{"goods_id":"142727","goods_name":"可口可乐500ML","price":"3.00","curr_num":14,"letter":"KKKL500ML","type":"0","pic":"\/res\/img\/panda\/backstage\/uploads\/gTemplate\/kkkl500.jpg","sort":"36"},{"goods_id":"120695","goods_name":"芬达橙汁汽水","price":"3.00","curr_num":31,"letter":"FDCZQS","type":"0","pic":"\/res\/img\/12\/12678\/attachment\/2018-11-26\/92db8f50dc562e342651657e9457d9c2.jpg","sort":"36"},{"goods_id":"120694","goods_name":"雪碧","price":"3.00","curr_num":14,"letter":"XB","type":"0","pic":"\/res\/img\/Upload\/goods\/20170328\/240_240_58da72c6ca8bc.jpg","sort":"36"},{"goods_id":"340752","goods_name":"康师傅冰红茶","price":"3.00","curr_num":14,"letter":"KSFBHC","type":"0","pic":"\/res\/img\/0\/0\/attachment\/2018-07-12\/1bf1ba1f5a84c62455d7b1183f01c1d5.jpg","sort":"37"},{"goods_id":"120879","goods_name":"康师傅绿茶","price":"3.00","curr_num":13,"letter":"KSFLC","type":"0","pic":"\/res\/img\/0\/0\/attachment\/2018-07-12\/fb257475887781fe21806b4b6dd43558.jpg","sort":"37"},{"goods_id":"370227","goods_name":"茶派(π)","price":"5.00","curr_num":3,"letter":"CP","type":"0","pic":"\/res\/img\/11\/11747\/attachment\/2018-10-27\/11ae3010204afd6e0e90609e8d9dec73.jpg","sort":"38"},{"goods_id":"142728","goods_name":"冰糖雪梨瓶装","price":"3.00","curr_num":11,"letter":"BTXLPZ","type":"0","pic":"\/res\/img\/upload\/oss\/image\/e14e6dcc6e6b66c74acb075c8fd32009.jpg","sort":"39"},{"goods_id":"366156","goods_name":"打火机（1元）","price":"1.00","curr_num":30,"letter":"DHJ1Y","type":"0","pic":"\/res\/img\/11\/11677\/attachment\/2018-10-14\/0549359a3a424e9341421c2f21defd78.jpg","sort":"100"},{"goods_id":"242619","goods_name":"统一金桔柠檬","price":"3.00","curr_num":0,"letter":"TYJJNM","type":"0","pic":"\/res\/img\/13\/13680\/goods\/2019-01-05\/5c3060d3902a0589864689.jpg","sort":"100"},{"goods_id":"232400","goods_name":"经典红双喜","price":"11.00","curr_num":108,"letter":"JDHSX","type":"0","pic":"\/res\/img\/12\/12176\/attachment\/2018-11-14\/7ba11f74980d71bbd3609d01ec1f19bc.jpg","sort":"100"},{"goods_id":"170960","goods_name":"纸巾（单小包）","price":"1.00","curr_num":125,"letter":"ZJDXB","type":"0","pic":"\/res\/img\/Upload\/goods\/20170921\/201706021613142151_src.jpg","sort":"100"},{"goods_id":"150109","goods_name":"蓝白沙","price":"11.00","curr_num":75,"letter":"LBS","type":"0","pic":"\/res\/img\/1\/1146\/goods\/2018-07-07\/5b3fb26c628ab585346670.jpg","sort":"100"},{"goods_id":"150108","goods_name":"黑利群(软)","price":"36.00","curr_num":41,"letter":"HLQR","type":"0","pic":"\/res\/img\/12\/12943\/attachment\/2018-11-27\/66271a72a8d9db0a9cbff8450274acc2.jpg","sort":"100"},{"goods_id":"150107","goods_name":"硬盒红利群","price":"22.00","curr_num":0,"letter":"YHHLQ","type":"0","pic":"\/res\/img\/0\/0\/goods\/2018-05-04\/5aec1ebbdccbc994434671.jpg","sort":"100"},{"goods_id":"120884","goods_name":"海之言","price":"4.00","curr_num":0,"letter":"HZY","type":"0","pic":"\/res\/img\/0\/0\/attachment\/2018-07-12\/2ad45df15467d1865ac4360ac1b48c09.jpg","sort":"100"},{"goods_id":"120883","goods_name":"味动力 乳酸菌","price":"6.00","curr_num":8,"letter":"WDL_RSJ","type":"0","pic":"\/res\/img\/12\/12927\/attachment\/2018-11-27\/e2623b36ad57478636c7212cf63e7d61.jpg","sort":"100"}]



function Loading (opt) {	
	var oWrapper = opt.oWrapper || document.body;
	var oLoading = document.createElement('div');
	oLoading.className = 'svgLoading01';
	oLoading.innerHTML = '\
		<svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">\
		<path class="pt1" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"/>\
		<path class="pt2" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z">\
			<animateTransform attributeType="xml"\
				attributeName="transform"\
				type="rotate"\
				from="0 20 20"\
				to="360 20 20"\
				dur="0.5s"\
				repeatCount="indefinite"/>\
			</path>\
		</svg>\
	';
	
	function show () {
		ns.removeElement(oLoading)
		oWrapper.appendChild(oLoading);
	}
	
	function close () {
		ns.removeElement(oLoading)
	}
	
	return {
		show: show,
		close: close
	};
}

// 排序按钮
Vue.component('sort-btn', {
	template: '\
		<div class="sortBtn" @click.prevent.self="toggleDir">\
			<div class="s-top" :class="{\'active\': dir==\'top\'}"></div>\
			<div class="s-bottom" :class="{\'active\': dir==\'bottom\'}"></div>\
		</div>\
	',
	data: function () {
		return {
			dir: ''
		}
	},
	methods: {
		refresh: function () {
			this.dir = ''
		},
		toggleDir: function () {
			var setDir = ''
			var self = this
			if(this.dir!='top') {
				setDir = 'top'
			}else if(this.dir!='bottom') {
				setDir = 'bottom'
			}
			this.$emit('on-change', setDir, function () {
				self.dir = setDir
			})
		}
	}
})

// 数字加减控件
Vue.component('number-count', {
	template: '\
		<div class="countBox" :class="{\'active\': active, \'change\': isChange}">\
			<div class="sub" @click="onSub">-</div>\
			<div class="add" @click="onAdd">+</div>\
			<div class="input">\
				<input\
					v-model="modelData"\
					@input="onInput"\
					@focus="onFocus"\
					@blur="onBlur">\
				</input>\
			</div>\
		</div>\
	',
	props: {
		value: {
			default: function () {
				return ''	
			}
		},
		copy: {
			default: function () {
				return ''
			}
		},
		source: {
			default: function () {
				return null
			}
		}
	},
	data: function () {
		return {
			modelData: '',
			active: false
		}
	},
	computed: {
		isChange: function () {
			return Number(this.modelData) - Number(this.copy)
		}
	},
	mounted: function () {
		var self = this;
		this.$nextTick(function () {
			self.modelData = self.value
		})
	},
	methods: {
		NaN: function (data) {
			if(isNaN(data)) {
				return 0
			}
			return data
		},
		onFocus: function () {
			this.active = true;
		},
		onBlur: function () {
			this.active = false;
		},
		onSub: function () {
			this.modelData = Number(this.modelData) - 1;
			this.modelData = this.NaN(this.modelData);
			this.$emit('input', this.modelData);
			this.$emit('on-sub', this.modelData, this.source);
		},
		onAdd: function () {
			this.modelData = Number(this.modelData) + 1;
			
			this.modelData = this.NaN(this.modelData);
			this.$emit('input', this.modelData);
			this.$emit('on-add', this.modelData, this.source);
		},
		onInput: function () {			
			this.modelData = this.NaN(this.modelData);
			this.$emit('input', this.modelData);
			this.$emit('on-input', this.modelData, this.source);
		}
	},
	watch: {
		value: function (newVal) {
			this.modelData = Number(newVal);
		}
	}
});









bestime.ready(function () {
	ns.loading = ns.createLoading()
	var errorTimes = 0;
	var errorAlert = false;
	var code = ns.getQuery().code;
	var tk = ns.getQuery().tk;
	var prevShiftId = ns.getQuery().prevShiftId;
	new Vue ({		
		el: '#app',
		data: {
			pandian: [],
			pandian_old: [],
			yipandian: [],
			yipandian_old: [],
			tabIndex: 0,
			searchStr: ''
		},
		mounted: function () {
			this.$nextTick(function () {				
				this.getTopHeight();
				this.getPandian();
				this.getYipandian();
			});
		},
		methods: {
			getTopHeight: function () {
				var height = ns.id('top').offsetHeight;
				var oScrollWrapper = ns.getByClass('tabContent')[0];				
				oScrollWrapper.style['margin-top'] = height + 'px';
			},
			getCorrectSrc: function (ev) {
				ns.imgOnerror(ev.currentTarget, appConfig.staticPath + '/images/default.jpg');
			},
			getYipandian: function () {
				this.getPandian(true)
			},
			getPandian: function (isYiPanDian) {
				var self = this;
				var query = {
					tk: tk,
					code: code,
					prevShiftId: prevShiftId,
					checked: isYiPanDian ? 1 : 0
				};
				ns.loading.show()
				$.ajax({
					url: appConfig.server_huangzhu + '/console.php/changeShift/mobile',
					type: 'GET',
					data: query,
					success: function (res) {
						res = ns.defaultType('Object', res)
						res.data = ns.defaultType('Object', res.data)
						res.data.goods = ns.defaultType('Array', res.data.goods)
						ns.loading.close()
						if(res.code==0) {
							var arr = []
							ns.each(res.data.goods, function (item) {
								item.isOperate = false; // 此商品是否被操作过
								item.isPush = false; // 此商品是否被提交
								item.pushing = false; // 此商品是否提交中
								arr.push(item)
							});

							console.log('arr', arr)
							
							if(isYiPanDian) {
								self.yipandian = ns.clone(arr);
								self.yipandian_old = ns.clone(arr)
							}else {
								self.pandian = ns.clone(arr);
								self.pandian_old = ns.clone(arr)
							}
						}else {
							if(!errorTimes) {
								ns.dialog({type: 2, msg: res.msg || JSON.stringify(res)});
								errorTimes++;
							}
						}
					},
					error: function (err) {
						ns.loading.close()
						if(!errorTimes) {
							ns.dialog({type: 2, msg: JSON.stringify(err)});
							errorTimes++;
						}
					}
				});
			},
			goTo: function (index) {
				errorTimes=0;
				this.tabIndex = index;
				if(index==0) {
					// 待盘点
					this.getPandian();
					this.clearSrotBtn()
					this.searchStr = ''
				}else if(index==1) {
					// 已盘点
					this.getYipandian();
					this.clearSrotBtn()
					this.searchStr = ''
				}
			},
			clearSrotBtn: function () {
				try { this.$refs._sname_ypd.refresh(); } catch(e) {}
				try { this.$refs._sprice_ypd.refresh(); } catch(e) {}
				try { this.$refs._skucun_ypd.refresh(); } catch(e) {}
				try { this.$refs._skucun.refresh(); } catch(e) {}
				try { this.$refs._sprice.refresh(); } catch(e) {}
				try { this.$refs._sname.refresh() } catch(e) {}
			},
			numChange: function (num, item) {
				item.isOperate = true;
			},
			confirmPandian: function (ev, item) {	
				if(item.pushing) return;
				var lod = Loading({
					oWrapper: ev.currentTarget.getElementsByClassName('comLoading')[0]
				});
				
				lod.show()
				item.pushing = true;				
				var query = {
					goods_id: item.goods_id,
					stock: item.curr_num,
					code: code,
					tk: tk
				};
				
				$.ajax({
					url: appConfig.server_yzq + '/console.php/shift/update_stock',
					type: 'POST',
					data: query,
					success: function (res) {
						item.pushing = false;
						lod.close()						
						if(res.code==0) {
							item.isPush = true;
							item.pushing = false;
							console.log('push', item.isPush)
						}else {							
							if(errorAlert) return;
							errorAlert = true;
							ns.dialog({
								msg: res.msg,
								onClosed: function (step) {
									console.log(step)
									errorAlert = false;
									if(res.code==5004) {
										window.location.reload()
									}
								}
							})
						}
					}
				});
			},
			// 按商品名排序
			s_change_name: function (dir, next) {
				this.pandian = this.pandian.sort(function (a, b) {
					if(dir=='bottom') {
						return a.goods_name.length - b.goods_name.length
					}else {
						return b.goods_name.length - a.goods_name.length
					}					
				})
				next();
			},
			// 按价格排序
			s_change_price: function (dir, next) {
				this.pandian = this.pandian.sort(function (a, b) {
					if(dir=='bottom') {
						return ns.toNumber(a.price) - ns.toNumber(b.price)
					}else {
						return ns.toNumber(b.price) - ns.toNumber(a.price)
					}					
				})
				next();
			},
			// 按库存排序
			s_change_kucun: function (dir, next) {
				this.pandian = this.pandian.sort(function (a, b) {
					if(dir=='bottom') {
						return ns.toNumber(a.curr_num) - ns.toNumber(b.curr_num)
					}else {
						return ns.toNumber(b.curr_num) - ns.toNumber(a.curr_num)
					}					
				})
				next();
			},


			// 已盘点 - 按商品名排序
			s_change_name_ypd: function (dir, next) {
				this.yipandian = this.yipandian.sort(function (a, b) {
					if(dir=='bottom') {
						return a.goods_name.length - b.goods_name.length
					}else {
						return b.goods_name.length - a.goods_name.length
					}					
				})
				next();
			},
			// 已盘点 - 按价格排序
			s_change_price_ypd: function (dir, next) {
				this.yipandian = this.yipandian.sort(function (a, b) {
					if(dir=='bottom') {
						return ns.toNumber(a.price) - ns.toNumber(b.price)
					}else {
						return ns.toNumber(b.price) - ns.toNumber(a.price)
					}					
				})
				next();
			},
			// 已盘点 -  按库存排序
			s_change_kucun_ypd: function (dir, next) {
				this.yipandian = this.yipandian.sort(function (a, b) {
					if(dir=='bottom') {
						return ns.toNumber(a.curr_num) - ns.toNumber(b.curr_num)
					}else {
						return ns.toNumber(b.curr_num) - ns.toNumber(a.curr_num)
					}					
				})
				next();
			},
		},
		
	})
});




